<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>A Royal Valentine Journey</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Pinyon+Script&display=swap');

:root {
    --romantic-red: #ff385c;
}

/* FIXED iPhone 100vh issue */
body {
    margin: 0;
    min-height: 100svh; /* modern safari safe viewport */
    overflow: hidden;
    background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    -webkit-tap-highlight-color: transparent;
}

/* Floating Hearts */
.pop-heart {
    position: absolute;
    color: rgba(255, 56, 92, 0.4);
    pointer-events: none;
    z-index: 1;
    animation: bubblePop 3s ease-in-out forwards;
}

@keyframes bubblePop {
    0% { transform: scale(0); opacity: 0; }
    50% { transform: scale(1.5); opacity: 0.8; }
    100% { transform: scale(2.2) translateY(-50px); opacity: 0; }
}

/* Pages */
.page {
    position: absolute;
    width: 100%;
    min-height: 100svh;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
}

/* Headings */
.bold-heading {
    font-size: clamp(1.8rem, 6vw, 3rem);
    font-weight: 900;
    color: var(--romantic-red);
    padding: 0 20px;
}

/* Letter Page */
.royal-letter-page {
    background: #000;
    overflow: hidden;
    position: relative;
}

/* Responsive masonry */
.photo-grid-container {
    position: absolute;
    top: 0;
    width: 100%;
    column-count: 2; /* MOBILE DEFAULT */
    column-gap: 8px;
    padding: 8px;
    opacity: 0.35;
    pointer-events: none;
    transform: translateY(-50%);
    animation: scrollVertical 25s linear infinite;
}

@media (min-width: 600px) {
    .photo-grid-container { column-count: 3; }
}

@media (min-width: 900px) {
    .photo-grid-container { column-count: 5; }
}

@keyframes scrollVertical {
    0% { transform: translateY(-50%); }
    100% { transform: translateY(0); }
}

.grid-img {
    width: 100%;
    margin-bottom: 8px;
    border-radius: 8px;
    break-inside: avoid;
}

/* Letter Box */
.letter-content {
    z-index: 100;
    background: rgba(253, 245, 230, 0.95);
    padding: 25px;
    width: 90%;
    max-width: 500px;
    border: 6px double #5d4037;
    box-shadow: 0 0 40px rgba(0,0,0,0.5);
    position: relative;
    transform: translateY(100svh);
    transition: 1.2s ease;
}

.letter-content.active {
    transform: translateY(0);
}

#typewriter {
    font-family: 'Pinyon Script', cursive;
    font-size: clamp(1.3rem, 5vw, 2rem);
    color: #2c1e1a;
    text-align: left;
    line-height: 1.6;
}

/* Wax Seal */
.wax-seal {
    width: 80px;
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%) scale(5);
    opacity: 0;
    transition: 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.wax-seal img {
    width: 100%;
}

.wax-seal.drop {
    opacity: 1;
    transform: translateX(-50%) scale(1);
}

/* Buttons */
.action-btn {
    padding: 12px 28px;
    font-size: clamp(1rem, 4vw, 1.4rem);
    font-weight: bold;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    transition: 0.3s;
}

.action-btn:active {
    transform: scale(0.95);
}

#yesBtn { background: #4CAF50; color: white; }
#noBtn { background: #f44336; color: white; }

/* GIF responsive */
.gif-box {
    width: 80%;
    max-width: 300px;
    border-radius: 20px;
    overflow: hidden;
    background: white;
    padding: 8px;
}
.gif-box img {
    width: 100%;
    height: auto;
}
</style>
</head>

<body>

<div id="heart-field"></div>

<audio id="bgMusic" loop playsinline>
<source src="song.mp3" type="audio/mpeg">
</audio>

<!-- PAGE 1 -->
<div id="page1" class="page" style="display:flex;">
    <div class="gif-box">
        <img id="main-gif" src="bubu-dudu-rides.webp">
    </div>
    <h1 class="bold-heading">Will you be my Valentine?</h1>
    <div style="display:flex; gap:20px; margin-top:25px;">
        <button id="yesBtn" class="action-btn">❤️ Yes ❤️</button>
        <button id="noBtn" class="action-btn">No</button>
    </div>
</div>

<!-- PAGE 3 -->
<div id="page3" class="page royal-letter-page">
    <div class="photo-grid-container" id="grid-container"></div>
    <div class="letter-content" id="letter">
        <div id="typewriter"></div>
        <div class="wax-seal" id="seal">
            <img src="my-stamp.png">
        </div>
    </div>
</div>

<script>
const sadGifs = [
"bubu-dudu-sseeyall.webp",
"bubu-dudu-sseeyall (1).webp",
"bubu-dudu-sseeyall (2).webp",
"Khoc.webp"
];

const myPhotos = [
"p1.png","p2.png","p3.png","p4.png","p5.png",
"p6.png","p7.png","p8.png","p9.png","p10.png",
"p11.png","p12.png","p13.png","p14.png","p15.png",
"p16.png","p17.png","p18.png","p19.png","p20.png"
];

let moveCount = 0;
let noClickCount = 0;

const noBtn = document.getElementById('noBtn');
const yesBtn = document.getElementById('yesBtn');
const mainGif = document.getElementById('main-gif');

/* Floating Hearts */
setInterval(()=>{
    const h=document.createElement('div');
    h.className='pop-heart';
    h.innerHTML='❤️';
    h.style.left=Math.random()*100+'vw';
    h.style.top=Math.random()*100+'vh';
    h.style.fontSize=(Math.random()*20+15)+'px';
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),3000);
},500);

/* TOUCH FIX: use click instead of hover */
noBtn.addEventListener('click',()=>{
    if(moveCount<3){
        noBtn.style.position='fixed';
        noBtn.style.left=Math.random()*70+'vw';
        noBtn.style.top=Math.random()*70+'vh';
        moveCount++;
        return;
    }

    noClickCount++;
    mainGif.src = sadGifs[Math.min(noClickCount-1,sadGifs.length-1)];
    yesBtn.style.transform = "scale(1.1)";
});

/* YES */
yesBtn.addEventListener('click',()=>{
    const music=document.getElementById('bgMusic');
    music.play().catch(()=>{});
    document.getElementById('page1').style.display='none';
    document.getElementById('page3').style.display='flex';

    const grid=document.getElementById('grid-container');
    const shuffled=[...myPhotos].sort(()=>Math.random()-0.5);
    const doubled=[...shuffled,...shuffled];

    doubled.forEach(src=>{
        const img=document.createElement('img');
        img.src=src;
        img.className='grid-img';
        grid.appendChild(img);
    });

    setTimeout(()=>{
        document.getElementById('letter').classList.add('active');
        typeLetter(`My Dear Love,

You are my forever and always.
In a world full of temporary things,
you are my constant.

I love you beyond words,
beyond time,
beyond forever.

Yours Eternally ❤️`);
    },800);
});

function typeLetter(text){
    let i=0;
    const target=document.getElementById('typewriter');
    target.innerHTML='';
    function typing(){
        if(i<text.length){
            target.innerHTML+= text[i]==='\n' ? '<br>' : text[i];
            i++;
            setTimeout(typing,45);
        }else{
            setTimeout(()=>document.getElementById('seal').classList.add('drop'),400);
        }
    }
    typing();
}
</script>

</body>
</html>
